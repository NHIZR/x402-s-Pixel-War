# x402's Pixel War - Solana åƒç´ å¾æœæ¸¸æˆ

ä¸€ä¸ªåŸºäº Solana åŒºå—é“¾çš„å¤šäººåƒç´ å¾æœæ¸¸æˆï¼Œé‡‡ç”¨ x402 æ”¯ä»˜åè®®ï¼ˆUSDCï¼‰ã€‚ç©å®¶é€šè¿‡æ”¯ä»˜ x402 ä»£å¸æ¥å é¢†åƒç´ ï¼Œä»·æ ¼éšå¾æœæ¬¡æ•°é€’å¢ 20%ã€‚

> ğŸ‰ **Day 1 å®Œæˆï¼** Mock æ”¯ä»˜ç³»ç»Ÿå’Œå é¢†åŠŸèƒ½å·²å®ç°ã€‚æŸ¥çœ‹ [Day 1 è¿›åº¦æŠ¥å‘Š](docs/DAY1_PROGRESS.md) äº†è§£è¯¦æƒ…ã€‚
>
> ğŸ“‹ **ä¸‹ä¸€æ­¥**: æ‰§è¡Œ[æ•°æ®åº“è¿ç§»](docs/SETUP_DATABASE.md)ï¼Œç„¶åå¼€å§‹æµ‹è¯•å é¢†åŠŸèƒ½ï¼

![Game Screenshot](docs/screenshots/wallet-connected.png)

## ğŸ® æ¸¸æˆæœºåˆ¶

- **åƒç´ æˆ˜åœº**: 50Ã—30 åƒç´ ç½‘æ ¼ï¼ˆ1,500 ä¸ªåƒç´ ï¼‰
- **åƒç´ å é¢†**: è¿æ¥ Solana é’±åŒ…ï¼Œæ”¯ä»˜ x402 (USDC) å é¢†ä»»æ„åƒç´ 
- **ä»·æ ¼é€’å¢**: æ¯æ¬¡å é¢†åä»·æ ¼ä¸Šæ¶¨ 20% (Ã—1.2)
- **åˆ©æ¶¦åˆ†é…**:
  - å‰ä»»æ‰€æœ‰è€…è·å¾—: æœ¬é‡‘ + 10% åˆ©æ¶¦
  - å¹³å°æ”¶å–: 10% "æˆ˜äº‰ç¨"
- **é¢œè‰²è‡ªå®šä¹‰**: å é¢†æ—¶å¯ä»¥é€‰æ‹©ä»»æ„é¢œè‰²
- **æ‰¹é‡å é¢†**: æ”¯æŒä¸€æ¬¡æ€§å é¢†å¤šä¸ªåƒç´ 

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
cd "x402's Pixel War"
npm install
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¤ºä¾‹æ–‡ä»¶
cp .env.local.example .env.local

# ç¼–è¾‘ .env.localï¼Œå¡«å…¥ä½ çš„é…ç½®
```

éœ€è¦é…ç½®:
- **Supabase**: æ•°æ®åº“è¿æ¥
- **Solana Network**: devnet (æµ‹è¯•ç½‘) æˆ– mainnet-beta (ä¸»ç½‘)
- **RPC Endpoint**: (å¯é€‰) è‡ªå®šä¹‰ RPC ç«¯ç‚¹

### 3. åˆå§‹åŒ–æ•°æ®åº“

1. è®¿é—® [Supabase Dashboard](https://supabase.com) â†’ SQL Editor
2. å¤åˆ¶å¹¶è¿è¡Œ `supabase/schema.sql`
3. éªŒè¯æ•°æ®åº“:

```sql
SELECT COUNT(*) FROM pixels;  -- åº”è¯¥è¿”å› 1500
```

### 4. è¿æ¥é’±åŒ…å¹¶è·å–æµ‹è¯•ä»£å¸

è¯¦ç»†æ­¥éª¤è¯·æŸ¥çœ‹: [é’±åŒ…è®¾ç½®æŒ‡å—](docs/WALLET_SETUP.md)

å¿«é€Ÿæ­¥éª¤:
1. å®‰è£… Phantom æˆ– Solflare é’±åŒ…
2. åˆ‡æ¢åˆ° Devnet (æµ‹è¯•ç½‘)
3. è·å–æµ‹è¯• SOL: https://faucet.solana.com/
4. è·å–æµ‹è¯• USDC (å‚è€ƒæ–‡æ¡£)

### 5. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—® [http://localhost:3000](http://localhost:3000)

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **æ¡†æ¶**: Next.js 15 (App Router), React 19, TypeScript
- **æ ·å¼**: Tailwind CSS, shadcn/ui
- **çŠ¶æ€ç®¡ç†**: Zustand
- **UI ç»„ä»¶**: Lucide React, Sonner (toasts)

### åŒºå—é“¾
- **ç½‘ç»œ**: Solana (Devnet/Mainnet)
- **é’±åŒ…**: @solana/wallet-adapter-react
- **æ”¯ä»˜åè®®**: x402 (USDC-based)
- **æ”¯æŒé’±åŒ…**: Phantom, Solflare, Torus

### åç«¯
- **æ•°æ®åº“**: Supabase (PostgreSQL)
- **å®æ—¶åŒæ­¥**: Supabase Realtime
- **è®¤è¯**: Solana é’±åŒ…ç­¾å

## ğŸ“ é¡¹ç›®ç»“æ„

```
x402's Pixel War/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ layout.tsx               # æ ¹å¸ƒå±€ï¼ˆåŒ…å« Solana Providerï¼‰
â”‚   â”œâ”€â”€ page.tsx                 # ä¸»é¡µï¼ˆåƒç´ ç½‘æ ¼ï¼‰
â”‚   â””â”€â”€ globals.css              # å…¨å±€æ ·å¼
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ game/                    # æ¸¸æˆç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Grid.tsx            # ä¸»ç½‘æ ¼ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Pixel.tsx           # å•ä¸ªåƒç´ 
â”‚   â”‚   â”œâ”€â”€ UserInfo.tsx        # ç”¨æˆ·ä¿¡æ¯å’Œé’±åŒ…è¿æ¥
â”‚   â”‚   â”œâ”€â”€ PixelInfoModal.tsx  # å•ä¸ªåƒç´ å é¢†å¼¹çª—
â”‚   â”‚   â”œâ”€â”€ BatchConquerModal.tsx  # æ‰¹é‡å é¢†å¼¹çª—
â”‚   â”‚   â””â”€â”€ ColorPicker.tsx     # é¢œè‰²é€‰æ‹©å™¨
â”‚   â”œâ”€â”€ providers/
â”‚   â”‚   â””â”€â”€ SolanaWalletProvider.tsx  # Solana é’±åŒ… Provider
â”‚   â””â”€â”€ ui/                      # shadcn/ui ç»„ä»¶
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ solana/
â”‚   â”‚   â””â”€â”€ balance.ts          # USDC ä½™é¢æŸ¥è¯¢
â”‚   â”œâ”€â”€ supabase/
â”‚   â”‚   â”œâ”€â”€ client.ts           # Supabase å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ server.ts           # Supabase æœåŠ¡ç«¯
â”‚   â”œâ”€â”€ stores/
â”‚   â”‚   â”œâ”€â”€ gameStore.ts        # æ¸¸æˆçŠ¶æ€
â”‚   â”‚   â””â”€â”€ userStore.ts        # ç”¨æˆ·çŠ¶æ€
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ game.types.ts       # TypeScript ç±»å‹
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ priceCalculation.ts # ä»·æ ¼è®¡ç®—å·¥å…·
â”œâ”€â”€ supabase/
â”‚   â””â”€â”€ schema.sql              # æ•°æ®åº“æ¶æ„
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ check-wallet.ts         # é’±åŒ…æ£€æŸ¥å·¥å…·
â”‚   â””â”€â”€ setup-test-usdc.sh      # æµ‹è¯• USDC è®¾ç½®è„šæœ¬
â””â”€â”€ docs/
    â”œâ”€â”€ WALLET_SETUP.md         # é’±åŒ…è®¾ç½®æŒ‡å—
    â””â”€â”€ HOW_TO_GET_DEVNET_USDC.md  # è·å–æµ‹è¯•ä»£å¸æŒ‡å—
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### âœ… å·²å®ç°
- âœ… Solana é’±åŒ…è¿æ¥ (Phantom, Solflare, Torus)
- âœ… USDC ä½™é¢æŸ¥è¯¢å’Œæ˜¾ç¤º
- âœ… 50Ã—30 åƒç´ ç½‘æ ¼æ˜¾ç¤º
- âœ… å®æ—¶åŒæ­¥ (Supabase Realtime)
- âœ… å•ä¸ªåƒç´ å é¢† UI
- âœ… æ‰¹é‡åƒç´ é€‰æ‹© (Shift + ç‚¹å‡»/æ‹–åŠ¨)
- âœ… æ‰¹é‡å é¢† UI
- âœ… é¢œè‰²é€‰æ‹©å™¨
- âœ… ä»·æ ¼è®¡ç®—å’Œæ˜¾ç¤º
- âœ… ä½™é¢æ£€æŸ¥
- âœ… **Mock x402 æ”¯ä»˜ç³»ç»Ÿ** (Day 1 å®Œæˆ ğŸ‰)
- âœ… **å•ä¸ªåƒç´ å é¢†é€»è¾‘** (å‰ç«¯ + åç«¯)
- âœ… **æ‰¹é‡åƒç´ å é¢†é€»è¾‘** (å‰ç«¯ + åç«¯)
- âœ… **Supabase RPC å‡½æ•°** (é’±åŒ…æ¡¥æ¥)

### ğŸš§ å¼€å‘ä¸­
- ğŸš§ æ•°æ®åº“è¿ç§»æ‰§è¡Œ (éœ€æ‰‹åŠ¨åœ¨ Supabase è¿è¡Œ SQL)
- ğŸš§ ç«¯åˆ°ç«¯æµ‹è¯•å’Œä¼˜åŒ–
- ğŸš§ çœŸå® x402 æ”¯ä»˜é›†æˆ (PayAI) - ç›®å‰ä½¿ç”¨ mock
- ğŸš§ äº¤æ˜“å†å²é¢æ¿
- ğŸš§ æ’è¡Œæ¦œ

### ğŸ“‹ è®¡åˆ’åŠŸèƒ½
- ğŸ“‹ NFT é“¸é€ ï¼ˆåƒç´ æ‰€æœ‰æƒè¯æ˜ï¼‰
- ğŸ“‹ ç¤¾äº¤åŠŸèƒ½ (èŠå¤©ã€é€šçŸ¥)
- ğŸ“‹ ç‰¹æ®Šäº‹ä»¶åƒç´ 
- ğŸ“‹ å›¢é˜Ÿå’Œè”ç›Ÿ

## ğŸ’° ç»æµæ¨¡å‹

### ä»·æ ¼é€’å¢è§„åˆ™

| å é¢†æ¬¡æ•° | ä»·æ ¼ (x402/USDC) | ç´¯è®¡æˆæœ¬ |
|---------|------------------|----------|
| 0 (åˆå§‹) | 0.01             | 0        |
| 1       | 0.01             | 0.01     |
| 5       | 0.025            | 0.074    |
| 10      | 0.062            | 0.255    |
| 20      | 0.383            | 2.19     |
| 50      | 91.0             | 765      |

### äº¤æ˜“ç¤ºä¾‹

Alice å é¢† Bob çš„åƒç´ ï¼ˆå½“å‰ä»·æ ¼: 1.0 x402ï¼‰:

1. **Alice æ”¯ä»˜**: 1.0 x402 (USDC)
2. **Bob è·å¾—**: 1.1 x402 (æœ¬é‡‘ + 10% åˆ©æ¶¦)
3. **å¹³å°æ”¶å–**: 0.1 x402 (10% æˆ˜äº‰ç¨)
4. **æ–°ä»·æ ¼**: 1.2 x402 (20% é€’å¢)

**å‡€æ•ˆæœ**:
- Alice: -1.0 ä½™é¢, +1 åƒç´ æ‰€æœ‰æƒ
- Bob: +0.1 åˆ©æ¶¦
- å¹³å°é‡‘åº“: +0.1 ç§¯ç´¯

## ğŸ”§ å¼€å‘æŒ‡å—

### æµ‹è¯•ç¯å¢ƒè®¾ç½®

1. **ä½¿ç”¨ Solana Devnet** (æ¨èç”¨äºå¼€å‘)
```bash
# .env.local
NEXT_PUBLIC_SOLANA_NETWORK=devnet
```

2. **è·å–æµ‹è¯• SOL å’Œ USDC**
```bash
# è¿è¡Œè®¾ç½®è„šæœ¬
./scripts/setup-test-usdc.sh
```

è¯¦ç»†æ–‡æ¡£: [è·å–æµ‹è¯•ä»£å¸æŒ‡å—](docs/HOW_TO_GET_DEVNET_USDC.md)

### æ•°æ®åº“æ¶æ„

**æ ¸å¿ƒè¡¨**:
- `pixels` - åƒç´ ç½‘æ ¼çŠ¶æ€ï¼ˆåæ ‡ã€é¢œè‰²ã€ä»·æ ¼ã€æ‰€æœ‰è€…ï¼‰
- `profiles` - ç”¨æˆ·èµ„æ–™ï¼ˆé’±åŒ…åœ°å€ã€ä½™é¢ã€ç»Ÿè®¡ï¼‰
- `transactions` - äº¤æ˜“å†å²
- `treasury` - å¹³å°é‡‘åº“

**RPC å‡½æ•°**:
- `initialize_grid()` - åˆå§‹åŒ–åƒç´ ç½‘æ ¼
- `conquer_pixel()` - åŸå­åŒ–å é¢†åƒç´ 
- `get_grid_state()` - è·å–ç½‘æ ¼çŠ¶æ€
- `get_user_stats()` - è·å–ç”¨æˆ·ç»Ÿè®¡

### è°ƒè¯•æŠ€å·§

1. **æŸ¥çœ‹é’±åŒ…è¿æ¥çŠ¶æ€**:
   - æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å° (F12)
   - æŸ¥çœ‹ "é’±åŒ…è¿æ¥çŠ¶æ€" æ—¥å¿—

2. **æ£€æŸ¥ USDC ä½™é¢**:
```bash
npx tsx scripts/check-wallet.ts <ä½ çš„é’±åŒ…åœ°å€>
```

3. **åœ¨çº¿æŸ¥çœ‹é’±åŒ…**:
   - Solana Explorer: https://explorer.solana.com/?cluster=devnet
   - Solscan: https://solscan.io/?cluster=devnet

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é’±åŒ…è®¾ç½®æŒ‡å—](docs/WALLET_SETUP.md) - è¯¦ç»†çš„é’±åŒ…é…ç½®è¯´æ˜
- [è·å–æµ‹è¯•ä»£å¸](docs/HOW_TO_GET_DEVNET_USDC.md) - å¦‚ä½•è·å–æµ‹è¯• SOL å’Œ USDC

## ğŸ¤ è´¡çŒ®

è¿™æ˜¯ä¸€ä¸ªå­¦ä¹ å’Œå®éªŒé¡¹ç›®ï¼Œæ¬¢è¿ fork å’Œæäº¤ PRï¼

### å¼€å‘è§„èŒƒ
- TypeScript strict mode
- ESLint + Prettier
- æäº¤å‰è¿è¡Œ `npm run lint`

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ™ é¸£è°¢

- Built with [Claude Code](https://claude.com/claude-code) by Anthropic
- Powered by [Solana](https://solana.com/)
- UI components by [shadcn/ui](https://ui.shadcn.com/)
- Database by [Supabase](https://supabase.com/)

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œç”¨äºå­¦ä¹  Solana å¼€å‘å’Œ x402 æ”¯ä»˜åè®®ã€‚è¯·å‹¿åœ¨ä¸»ç½‘ä¸Šä½¿ç”¨çœŸå®èµ„é‡‘è¿›è¡Œæµ‹è¯•ã€‚
